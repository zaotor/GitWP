/* 
 * WinJS Contrib v2.0.0.6
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

!function(){"use strict";function e(e){console.log(e)}WinJS.Namespace.define("WinJSContrib.UI",{parentFlyoutPage:function(e){if(!e)return null;for(var t=e.parentNode;t;){if(t.mcnFlyoutPage)return t.winControl;t=t.parentNode}},FlyoutPageTrigger:WinJS.Class.define(function(e,t){var n=this;n.element=e||document.createElement("DIV"),t=t||{},n.element.classList.add("win-disposable"),WinJS.UI.setOptions(this,t),$(n.element).tap(function(){n.openFlyout()},t.tapOptions)},{openFlyout:function(){this.flyoutpage&&this.flyoutpage.winControl&&this.flyoutpage.winControl.show()}}),FlyoutPage:WinJS.Class.mix(WinJS.Class.define(function(t,n){var i=this;i.eventTracker=new WinJSContrib.UI.EventTracker,i.element=t||document.createElement("DIV"),n=n||{},i.element.mcnFlyoutPage=!0,i.element.winControl=i,i.element.classList.add("mcn-flyoutpage"),i.element.classList.add("mcn-navigation-ctrl"),i.element.classList.add("mcn-flyout"),i.element.classList.add("win-disposable"),i.hardwareBackBtnPressedBinded=i.hardwareBackBtnPressed.bind(i),i._container=document.createElement("DIV"),i._container.className="mcn-flyoutpage-area",i._overlay=document.createElement("DIV"),i._overlay.className="mcn-flyoutpage-overlay",i._overlay.innerHTML='<DIV class="mcn-flyoutpage-overlay-bg"></DIV>',i._container.appendChild(i._overlay),$(i._overlay).tap(function(){i.hide()},{disableAnimation:!0}),i._wrapper=document.createElement("DIV"),i._wrapper.className="mcn-flyoutpage-contentwrapper",i._container.appendChild(i._wrapper),i._wrapperArea=document.createElement("DIV"),i._wrapperArea.className="mcn-flyoutpage-contentwrapperarea",i._wrapper.appendChild(i._wrapperArea),i._bg=document.createElement("DIV"),i._bg.className="mcn-flyoutpage-bg",i._wrapperArea.appendChild(i._bg),i._content=document.createElement("DIV"),i._content.className="mcn-flyoutpage-content",i._wrapperArea.appendChild(i._content),n.edgeSwipe&&WinJSContrib.UI.SwipeSlide&&(e("flyout page edge swipe"),i.edgeSwipeCtrl=new WinJSContrib.UI.SwipeSlide(null,{moveDivider:1,threshold:4,allowed:{left:!1,right:!1}}),i.edgeSwipeCtrl.element.classList.add("mcn-edgeswipe"),document.body.appendChild(i.edgeSwipeCtrl.element),i.eventTracker.addEvent(i.edgeSwipeCtrl,"swipestart",function(e){i._edgeSwipeStart(e)}),i.eventTracker.addEvent(i.edgeSwipeCtrl,"swipe",function(e){i._edgeSwipeCompleted(e)})),n.swipeToClose&&WinJSContrib.UI.SwipeSlide&&(e("flyout page swipe to close"),i.swipeToCloseCtrl=new WinJSContrib.UI.SwipeSlide(i._wrapperArea,{moveDivider:1,allowed:{left:!1,right:!1}}),i.eventTracker.addEvent(i.swipeToCloseCtrl,"swipe",function(e){i._swipeToCloseCompleted(e)})),WinJS.UI.setOptions(this,n),i.enterAnimation||(i.enterAnimation=n.enterAnimation||WinJS.UI.Animation.enterPage),i.exitAnimation||(i.exitAnimation=n.exitAnimation||WinJS.UI.Animation.exitPage),n.uri?new WinJS.UI.HtmlControl(i._content,{uri:n.uri},function(e){i.contentCtrl=e,WinJSContrib.UI.bindMembers(e.element,e),e.flyoutPage=i,i.bindLinks()}):(WinJSContrib.Utils.moveChilds(i.element,i._content),i.bindLinks()),i.element.appendChild(i._container),i._swipeTargets(),i.display||(i.display="overlay")},{content:{get:function(){return this._content}},display:{get:function(){return this._display},set:function(e){var t="overlay";"move"==e&&(t="move"),this.element.classList.remove("mcn-overlay"),this.element.classList.remove("mcn-move"),this.element.classList.add("mcn-"+t),this._display=t,this._swipeTargets()}},placement:{get:function(){return this._placement},set:function(e){var t=this;this._placement=e,"right"==this._placement?(t.edgeSwipeCtrl&&(t.edgeSwipeCtrl.allowed.left=!0,t.edgeSwipeCtrl.element.classList.remove("mcn-edgeswipe-left"),t.edgeSwipeCtrl.element.classList.add("mcn-edgeswipe-right")),t.swipeToCloseCtrl&&(t.swipeToCloseCtrl.allowed.right=!0),t.element.classList.add("partial-right"),t.enterAnimation||(t.enterAnimation=function(e){return WinJSContrib.UI.Animation.slideFromRight(e,{duration:300})}),t.exitAnimation||(t.exitAnimation=function(e){return WinJSContrib.UI.Animation.slideToRight(e,{duration:120})})):"left"==this._placement?(t.edgeSwipeCtrl&&(t.edgeSwipeCtrl.allowed.right=!0,t.edgeSwipeCtrl.element.classList.remove("mcn-edgeswipe-right"),t.edgeSwipeCtrl.element.classList.add("mcn-edgeswipe-left")),t.swipeToCloseCtrl&&(t.swipeToCloseCtrl.allowed.left=!0),t.element.classList.add("partial-left"),t.enterAnimation||(t.enterAnimation=function(e){return WinJSContrib.UI.Animation.slideFromLeft(e,{duration:300})}),t.exitAnimation||(t.exitAnimation=function(e){return WinJSContrib.UI.Animation.slideToLeft(e,{duration:120})})):"bottom"==this._placement?(t.element.classList.add("partial-bottom"),t.enterAnimation||(t.enterAnimation=function(e){return WinJSContrib.UI.Animation.slideFromBottom(e,{duration:300})}),t.exitAnimation||(t.exitAnimation=function(e){return WinJSContrib.UI.Animation.slideToBottom(e,{duration:120})})):"top"==this._placement&&(t.element.classList.add("partial-top"),t.enterAnimation||(t.enterAnimation=function(e){return WinJSContrib.UI.Animation.slideFromTop(e,{duration:300})}),t.exitAnimation||(t.exitAnimation=function(e){return WinJSContrib.UI.Animation.slideToTop(e,{duration:120})}))}},hardwareBackBtnPressed:function(e){var t=this,n=WinJSContrib.UI.FlyoutPage.openPages.indexOf(t);n==WinJSContrib.UI.FlyoutPage.openPages.length-1&&(t.hide(),e.handled=!0,e.preventDefault&&e.preventDefault())},addContentElement:function(e){var t=this;t._content.appendChild(e)},pick:function(e,t){var n=this;t=t||{},t.uri=e;var i=new WinJS.Promise(function(e){new WinJS.UI.HtmlControl(n._content,t,function(t){n.contentCtrl=t,t.close=function(e){n.hide(e)},t.flyoutPage=n,WinJSContrib.UI.bindMembers(t.element,t),n.bindLinks(),n.show(),n.onbeforehide=function(){n.onbeforehide=null;var t=n.result;setImmediate(function(){e(t)})},n.onafterhide=function(){n.onafterhide=null,WinJS.Utilities.disposeSubTree(n._content),n.contentCtrl.unload&&n.contentCtrl.unload(),n.contentCtrl=null,n._content.innerHTML=""}})});return i},registerBack:function(){var e=this;e.edgeSwipeCtrl&&(e.edgeSwipeCtrl.disabled=!0),e.navEventsHandler=WinJSContrib.UI.registerNavigationEvents(e,this.hardwareBackBtnPressedBinded)},show:function(){var e=this;e.contentCtrl&&e.contentCtrl.beforeshow&&e.contentCtrl.beforeshow(),this.dispatchEvent("beforeshow"),e.element.classList.add("visible"),e._wrapper.classList.add("visible"),e._wrapper.style.opacity="0",e._overlay.style.opacity="0",e._overlay.classList.add("visible"),e.registerBack(),WinJSContrib.UI.Animation.fadeIn(e._overlay,{duration:400});var t=WinJS.Promise.wrap();return e.contentCtrl&&e.contentCtrl.beforeShowContent&&(t=WinJS.Promise.as(e.contentCtrl.beforeShowContent())),t.then(function(){return WinJS.Promise.timeout()}).then(function(){return e.calcAutosize(),WinJS.Promise.timeout()}).then(function(){return e.enterAnimation(e._wrapper)}).then(function(){WinJSContrib.UI.FlyoutPage.openPages.push(e),e.contentCtrl&&e.contentCtrl.aftershow&&e.contentCtrl.aftershow(),e.dispatchEvent("aftershow")})},calcAutosize:function(){var e=this;if(e.autosize)if("top"==e.placement||"bottom"==e.placement){var t=$(".mcn-flyoutpage-content",e.element).children().first(),n=t.outerHeight();$(".mcn-flyoutpage-contentwrapper",e.element).height(n)}else if("left"==e.placement||"right"==e.placement){var t=$(".mcn-flyoutpage-content",e.element).children().first(),n=t.outerWidth();$(".mcn-flyoutpage-contentwrapper",e.element).width(n)}},hide:function(e){var t=this;return t.result=e,t.contentCtrl&&t.contentCtrl.beforehide&&t.contentCtrl.beforehide(),this.dispatchEvent("beforehide"),this._removeNavigationLocks(),WinJS.Promise.join([t.exitAnimation(t._wrapper),WinJSContrib.UI.Animation.fadeOut(t._overlay,{duration:200})]).then(function(){return WinJS.Promise.timeout(100)}).then(function(){t._wrapper.classList.remove("visible"),$(".mcn-flyoutpage-contentwrapper",t.element).css("width","").css("height","")}).then(function(){var e=WinJSContrib.UI.FlyoutPage.openPages.indexOf(t);WinJSContrib.UI.FlyoutPage.openPages.splice(e,1),t._wrapper.style.opacity="",t._overlay.style.opacity="",t._overlay.classList.remove("visible"),t.element.classList.remove("visible"),t.contentCtrl&&t.contentCtrl.afterhide&&t.contentCtrl.afterhide(),t.dispatchEvent("afterhide")})},_removeNavigationLocks:function(){var e=this;e.navEventsHandler&&(e.navEventsHandler(),e.navEventsHandler=null),e.edgeSwipeCtrl&&(e.edgeSwipeCtrl.disabled=!1)},bindLinks:function(){var e=this;$("*[data-flyout]",e.element).each(function(){var t=$(this).data("flyout");t&&$(this).tap(function(){var n=$(t);n.length&&n[0].winControl&&n[0].winControl.show&&(e.element.style.zIndex="500",e.hide().done(function(){e.element.style.zIndex=""}),n[0].winControl.show())})}),$("*[data-link]",e.element).each(function(){var t=$(this).data("link");if(t&&t.indexOf("/")<0){var n=WinJSContrib.Utils.readProperty(window,t);n&&(t=n)}t&&$(this).tap(function(n){var i=$(n).data("link-args");if(i&&"string"==typeof i)try{var o=WinJSContrib.Utils.readValue(n,i);i=o?o:JSON.parse(i)}catch(r){return}e.hide().then(function(){WinJS.Navigation.navigate(t,i)})})}),$("*[data-action]",e.element).each(function(){var t=$(this).data("action"),n=e._content.winControl[t];n&&"function"==typeof n&&$(this).tap(function(n){var i=$(n).data("action-args");if(i&&"string"==typeof i)try{var o=WinJSContrib.Utils.readValue(n,i);i=o?o:JSON.parse(i)}catch(r){return}e.hide().then(function(){e._content.winControl[t].bind(e._content.winControl)({elt:n,args:i})})})})},_swipeTargets:function(){var e=this;e.edgeSwipeCtrl&&("overlay"==e.display?e.edgeSwipeCtrl.target=e._container:"move"==e.display&&(e.edgeSwipeCtrl.target=e.element.parentElement)),e.swipeToCloseCtrl&&("overlay"==e.display?e.swipeToCloseCtrl.target=e._wrapperArea:"move"==e.display&&(e.swipeToCloseCtrl.target=e.element.parentElement))},_edgeSwipeStart:function(){var t=this;if(t.edgeSwipeCtrl.minMoveBounds=null,t.edgeSwipeCtrl.maxMoveBounds=null,"right"==t.placement){var n=-1*t._content.clientWidth;e("minBounds "+n),t.edgeSwipeCtrl.minMoveBounds=n}else if("left"==t.placement){var n=t._content.clientWidth;e("maxBounds "+n),t.edgeSwipeCtrl.maxMoveBounds=n}},_edgeSwipeCompleted:function(t){var n=this;if(e("swiped by "+t.move+"/"+t.screenMove+" "+document.body.clientWidth/3),Math.abs(t.screenMove)>document.body.clientWidth/3){if(n.edgeSwipeCtrl.swipeHandled=!0,n.element.classList.add("visible"),n._wrapper.classList.add("visible"),"overlay"==n.display)n.edgeSwipeCtrl.target.style.transform="",n.edgeSwipeCtrl.target.style.hasOwnProperty("webkitTransform")&&(n.edgeSwipeCtrl.target.style.webkitTransform=""),"right"==n.placement?n._wrapper.style.transform="translate("+(document.body.clientWidth+t.screenMove)+"px, 0)":"left"==n.placement&&(n._wrapper.style.transform="translate("+t.screenMove+"px, 0)"),WinJS.UI.executeTransition(n._wrapper,{property:"transform",delay:10,duration:600*(1-(document.body.clientWidth+t.screenMove)/document.body.clientWidth),easing:"ease-out",to:"translate(0,0)"});else if("move"==n.display){var i=n.edgeSwipeCtrl.minMoveBounds||n.edgeSwipeCtrl.maxMoveBounds;WinJS.UI.executeTransition(n.edgeSwipeCtrl.target,{property:"transform",delay:10,duration:600*(1-(document.body.clientWidth+t.screenMove)/document.body.clientWidth),easing:"ease-out",to:"translate("+i+"px,0)"})}n._overlay.style.opacity="0",n._overlay.classList.add("visible"),WinJSContrib.UI.Animation.fadeIn(n._overlay,{duration:400}),n.registerBack()}},_swipeToCloseCompleted:function(t){var n=this,i=n.swipeToCloseCtrl;if(e("swiped back by "+t.move+"/"+t.screenMove+" "+document.body.clientWidth/4+"("+i.swipeHandled+")"),Math.abs(t.screenMove)>document.body.clientWidth/4)if(i.swipeHandled=!0,n._removeNavigationLocks(),WinJSContrib.UI.Animation.fadeOut(n._overlay,{duration:300}).then(function(){n._overlay.classList.remove("visible")}),"overlay"==n.display){var o="0",r="0";"right"==n.placement?o="100%":"left"==n.placement&&(o="-100%"),WinJS.UI.executeTransition(n._wrapper,{property:"transform",delay:10,duration:500*(1-(document.body.clientWidth-t.screenMove)/document.body.clientWidth),easing:"ease-out",to:"translate("+o+","+r+")"}).then(function(){return n._wrapper.classList.remove("visible"),n.element.classList.remove("visible"),n.hide()}).then(function(){n._wrapperArea.style.transform="",n._wrapperArea.style.hasOwnProperty("webkitTransform")&&(n._wrapperArea.style.webkitTransform="")})}else"move"==n.display&&WinJS.UI.executeTransition(n.element.parentElement,{property:"transform",delay:10,duration:500*(1-(document.body.clientWidth-t.screenMove)/document.body.clientWidth),easing:"ease-out",to:"translate(0,0)"}).then(function(){return n._wrapper.classList.remove("visible"),n.element.classList.remove("visible"),n.hide()}).then(function(){n._wrapperArea.style.transform="",n._wrapperArea.style.hasOwnProperty("webkitTransform")&&(n._wrapperArea.style.webkitTransform="")})},dispose:function(){var e=this;e.eventTracker.dispose(),e.edgeSwipeCtrl&&(e.edgeSwipeCtrl.dispose(),$(e.edgeSwipeCtrl.element).remove()),e.swipeToCloseCtrl&&e.swipeToCloseCtrl.dispose(),WinJS.Utilities.disposeSubTree(this.element)}}),WinJS.Utilities.eventMixin,WinJS.Utilities.createEventProperties("beforeshow","beforehide","aftershow","afterhide"))}),WinJSContrib.UI.FlyoutPage.openPages=[],WinJS.Namespace.define("WinJSContrib.UI",{FlyoutPicker:WinJS.Class.mix(WinJS.Class.define(function(e,t){var n=this;n.element=e||document.createElement("DIV"),t=t||{},n.element.style.display="none",n.element.classList.add("mcn-flyoutpicker"),n.element.classList.add("win-disposable"),n.element.mcnFlyoutPage=!0,n.element.winControl=n,n.flyoutPage=new WinJSContrib.UI.FlyoutPage(null,t);var i=WinJSContrib.UI.parentFlyoutPage(e);i?i.addContentElement(n.flyoutPage.element):document.body.appendChild(n.flyoutPage.element)},{dispose:function(){var e=this;$(e.flyoutPage.element).remove(),$(e.element).remove(),e.flyoutPage=null},addContentElement:function(e){var t=this;t.flyoutPage.addContentElement(e)},pick:function(e,t){var n=this;return n.flyoutPage.pick(e,t)}}),WinJS.UI.DOMEventMixin,WinJS.Utilities.createEventProperties(""))})}();