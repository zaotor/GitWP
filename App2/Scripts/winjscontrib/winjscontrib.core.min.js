Object.map||(Object.map=function(n,t){var r={};return"object"!=typeof n?r:("function"!=typeof t&&(t=function(n,t){return[n,t]}),Object.keys(n).forEach(function(e){var i=t.apply(n,[e,n[e]]);i&&i.length&&(r[i[0]||e]=i[1])}),r)}),String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,r){return"undefined"!=typeof n[r]?n[r]:t})}),String.prototype.padLeft||(String.prototype.padLeft=function(n,t){return void 0===t&&(t="0"),this.length<n?(t+this).padLeft(n,t):this});var WinJSContrib=WinJSContrib||{};WinJSContrib.UI=WinJSContrib.UI||{},WinJSContrib.Utils=WinJSContrib.Utils||{},WinJSContrib.Promise=WinJSContrib.Promise||{},function(){"use strict";function n(n,t){if(n){if("this"===t)return n;var r=n[t];if("undefined"!=typeof r)return r;var e=t.indexOf("[");if(!(0>e)){var i=t.indexOf("]",e);if(!(0>i)){var o=t.substr(e+1,i-e);return o=parseInt(o),n[o]}}}}function t(n,t,r){t&&(n[t]=r,n.setProperty&&n.setProperty(t,r));var e=t.indexOf("[");if(!(0>e)){var i=t.indexOf("]",e);if(!(0>i)){var o=t.substr(e+1,i-e);o=parseInt(o),n[o]=r}}}function r(n){var t=[],r=n.querySelectorAll(".mcn-layout-ctrl");if(r&&r.length)for(var e=0;e<r.length;e++){var i=r[e].winControl;i&&t.push(i)}return t}function e(n,t,r){var e=[];if(t&&t.length)for(var i=0;i<t.length;i++){var o=t[i];o.prepare&&e.push(WinJS.Promise.as(o.prepare(n.element,r)))}n&&n.prepare&&e.push(WinJS.Promise.as(n.prepare(n.element,r)));var a=WinJS.Promise.join(e);return n.addPromise(a),a}function i(n,t,r){var e=WinJS.Promise.wrap(),i=[];if(t&&t.length){for(var o=0;o<t.length;o++){var a=t[o];a.pageLayout&&i.push(WinJS.Promise.as(a.pageLayout(n.element,r)))}e=WinJS.Promise.join(i)}if(n&&n.layoutPage){var s=WinJS.Promise.as(n.layoutPage(n.element,r));e=i.length?e.then(function(){return s}):s}return n.addPromise(e),e}function o(n,t,r,e){if(n&&n.contentReady&&n.contentReady(n.element,r),t&&t.length)for(var i=0;i<t.length;i++){var o=t[i];o.contentReady&&o.contentReady(n.element,r)}if(n.enterPageAnimation)return WinJS.Promise.as(n.enterPageAnimation());if(n.element.style.opacity="",e.enterPage){var a=null;if(a=n&&n.getAnimationElements?n.getAnimationElements(isExit):n.element)return e.enterPage(a)}}function a(n,t,r){if(n&&n.pageReady&&n.pageReady(n.element,r),t&&t.length)for(var e=0;e<t.length;e++){var i=t[e];i.pageReady&&i.pageReady(n.element,r)}}WinJSContrib.UI.offsetFrom=function(n,t){for(var r=0,e=0;n&&n!=t;)r+=n.offsetLeft-n.scrollLeft+n.clientLeft,e+=n.offsetTop-n.scrollTop+n.clientTop,n=n.offsetParent;return{x:r,y:e,width:n.clientWidth,height:n.clientHeight}},WinJSContrib.UI.EventTracker=function(){this.events=[]},WinJSContrib.UI.EventTracker.prototype.addEvent=function(n,t,r,e){n.addEventListener(t,r,e);var i=function(){try{n.removeEventListener(t,r)}catch(e){}};return this.events.push(i),i},WinJSContrib.UI.EventTracker.prototype.addBinding=function(n,t,r){n.bind(t,r);var e=function(){n.unbind(t,r)};return this.events.push(e),e},WinJSContrib.UI.EventTracker.prototype.dispose=function(){for(var n=0;n<this.events.length;n++)this.events[n]();this.events=[]},WinJSContrib.UI.appbarsOpen=function(){var n=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(n&&n.length)for(var t=0;t<n.length;t++)n[t].winControl&&n[t].winControl.show()},WinJSContrib.UI.appbarsClose=function(){var n=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(n&&n.length)for(var t=0;t<n.length;t++)n[t].winControl&&n[t].winControl.hide()},WinJSContrib.UI.appbarsDisable=function(){var n=document.querySelectorAll('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]');if(n&&n.length)for(var t=0;t<n.length;t++)n[t].winControl&&(n[t].winControl.disabled=!0)},WinJSContrib.UI.appbarsEnable=function(){$('div[data-win-control="WinJS.UI.AppBar"],div[data-win-control="WinJS.UI.NavBar"]').each(function(){this.winControl&&(this.winControl.disabled=!1)})},WinJSContrib.UI.elementLoaded=function(n,t){return new WinJS.Promise(function(r,e){function i(){n.onload=void 0,n.onerror=void 0,n.onreadystatechange=void 0,e("element not loaded")}function o(){n.onload=void 0,n.onerror=void 0,n.onreadystatechange=void 0,r({element:n,url:t})}n.onerror=i,n.onload=o,n.onreadystatechange=o,n.naturalWidth>0&&o(void 0),n.src=t})},WinJSContrib.UI.loadImage=function(n){return new WinJS.Promise(function(t,r){function e(){o.onload=void 0,o.onerror=void 0,r("image not loaded")}function i(){o.onload=void 0,o.onerror=void 0,t({element:o,url:n})}var o=new Image;o.onerror=e,o.onload=i,o.naturalWidth>0&&i(void 0),o.src=n})},WinJSContrib.UI.listElementsAfterMe=function(n){var t=[],r=!1;if(n.parentElement)for(var e=n.parentElement,i=0;i<e.children.length;i++)e.children[i]===n?r=!0:r&&t.push(e.children[i]);return t},WinJSContrib.UI.removeElementAnimation=function(n){return new WinJS.Promise(function(t){var r=WinJSContrib.UI.listElementsAfterMe(n),e=WinJS.UI.Animation.createDeleteFromListAnimation([n],r);n.style.position="fixed",n.style.opacity="0",e.execute().done(function(){t(n)})})},WinJSContrib.UI.bindPageActions=function(n,t){$("*[data-page-action]",n).each(function(){var n=$(this).addClass("page-action").data("page-action"),r=t[n];r&&"function"==typeof r&&$(this).tap(function(r){var e=$(r).data("page-action-args");if(e&&"string"==typeof e)try{var i=WinJSContrib.Utils.readValue(r,e);e=i?i:JSON.parse(e)}catch(o){return}t[n].bind(t)({elt:r,args:e})})})},WinJSContrib.UI.bindPageLinks=function(n){$("*[data-page-link]",n).each(function(){var n=$(this).addClass("page-link").data("page-link");if(n&&n.indexOf("/")<0){var t=WinJSContrib.Utils.readProperty(window,n);t&&(n=t)}n&&$(this).tap(function(t){var r=$(t).data("page-action-args");if(r&&"string"==typeof r)try{var e=WinJSContrib.Utils.readValue(t,r);r=e?e:JSON.parse(r)}catch(i){return}if(WinJSContrib.UI.parentNavigator&&WinJSContrib.UI.parentNavigator(t)){var o=WinJSContrib.UI.parentNavigator(t);o.navigate(n,r)}else WinJS.Navigation.navigate(n,r)})})},WinJSContrib.UI.bindMembers=function(n,t){$("*[data-page-member]",n).each(function(){var n=$(this).addClass("page-member").data("page-member");n||(n=this.id),n&&!t[n]&&(t[n]=this,this.winControl&&(t[n]=this.winControl))})},WinJSContrib.UI.bindActions=function(n,t){WinJSContrib.UI.bindPageActions(n,t),WinJSContrib.UI.bindPageLinks(n)},WinJSContrib.Promise.waterfall=function(n,t){var r=WinJS.Promise.wrap(),e=[];if(!n)return WinJS.Promise.wrap([]);var i=WinJS.Promise.as(n);return i.then(function(n){for(var i=function(n,r){return n.then(function(){return WinJS.Promise.as(t(r)).then(function(n){e.push(n)})})},o=0,a=n.length;a>o;o++)r=i(r,n[o]);return r.then(function(){return e})})},WinJSContrib.Promise.promises=function(n,t){if(!n)return WinJS.Promise.wrap([]);var r=WinJS.Promise.as(n);return r.then(function(n){for(var r=[],e=0,i=n.length;i>e;e++)r.push(WinJS.Promise.as(t(n[e])));return r})},WinJSContrib.Promise.parallel=function(n,t){if(!n)return WinJS.Promise.wrap([]);var r=WinJS.Promise.as(n);return r.then(function(n){for(var r=[],e=0,i=n.length;i>e;e++)r.push(WinJS.Promise.as(t(n[e])));return WinJS.Promise.join(r)})},WinJSContrib.Promise.batch=function(n,t,r){if(!n)return WinJS.Promise.wrap([]);var e=WinJS.Promise.as(n);return e.then(function(n){for(var e=WinJS.Promise.wrap(),i=[],o=[],a=!1,s=function(n,t){return n.then(function(){return WinJS.Promise.join(t.map(function(n){return WinJS.Promise.as(r(n))})).then(function(n){n=n.concat(n)},function(n){o=o.concat(n),a=!0})})},u=0,l=n.length;l>u;u++)i.push(n[u]),u>0&&u%t==0&&(e=s(e,i),i=[]);return i.length&&(e=s(e,i)),e.then(function(){return a?WinJS.Promise.wrapError(o):o})})},WinJSContrib.Utils.startsWith=function(n,t){if(!t)return!1;var r=n.match("^"+t)==t;return r},String.prototype.startsWith||(String.prototype.startsWith=function(n){return WinJSContrib.Utils.startsWith(this,n)}),WinJSContrib.Utils.endsWith=function(n,t){return t?n.match(t+"$")==t:!1},String.prototype.endsWith||(String.prototype.endsWith=function(n){return WinJSContrib.Utils.endsWith(this,n)}),WinJSContrib.Utils.queryStringFrom=function(n){var t=[];for(var r in n)n.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(n[r]));return t.join("&")},WinJSContrib.Utils.triggerEvent=function(n,t,r,e){var i=document.createEvent("Event");i.initEvent(t,r,e),n.dispatchEvent(i)},WinJSContrib.Utils.triggerCustomEvent=function(n,t,r,e,i){var o=document.createEvent("CustomEvent");o.initCustomEvent(t,r,e,i),n.dispatchEvent(o)},WinJSContrib.Utils.readProperty=function(n,t){if("string"==typeof t&&n[t])return n[t];if(!t||!t.length)return n;var r=WinJSContrib.Utils.getProperty(n,t);return r?r.propValue:void 0},WinJSContrib.Utils.getProperty=function(r,e){"string"==typeof e&&(e=e.split(".")),e&&e.length||(e=["this"]);for(var i=r,o=null,a=0;a<e.length;a++){var s={parent:i,parentDescriptor:o,keyProp:e[a],ensureParent:function(){return i?i:void(this.parentDescriptor&&(this.parentDescriptor.ensureParent(),this.parentDescriptor.parent[this.parentDescriptor.keyProp]||(this.parentDescriptor.parent[this.parentDescriptor.keyProp]={},this.parent=this.parentDescriptor.parent[this.parentDescriptor.keyProp])))},get propValue(){return n(this.parent,this.keyProp)},set propValue(n){return this.ensureParent(),t(this.parent,this.keyProp,n)}};if(o=s,a==e.length-1)return s;i=n(i,e[a])}},WinJSContrib.Utils.writeProperty=function(n,t,r){var e=WinJSContrib.Utils.getProperty(n,t);e&&(e.propValue=r)},WinJSContrib.Utils.randomFromInterval=function(n,t){return Math.random()*(t-n+1)+n<<0},WinJSContrib.Utils.alphabeticSort=function(n,t){return n>t?1:t>n?-1:0},WinJSContrib.Utils.distinctArray=function(n,t,r){if(null==n||0==n.length)return n;"undefined"==typeof r&&(r=!1);var e="",i=0,o=[];if(r)for(var a=0;a<n.length;a++){if(t){var s=WinJSContrib.Utils.readProperty(n[a],t.split(".")),u=s;s||(u=s),s&&s.toLowerCase&&(u=s.toLowerCase())}else var u=n[a];e.indexOf("|"+u+"|")<0&&(e+="|"+u+"|",o[i++]=n[a])}else for(var a=0;a<n.length;a++){if(t)var u=WinJSContrib.Utils.readProperty(n[a],t.split("."));else var u=n[a];e.indexOf("|"+u+"|")<0&&(e+="|"+u+"|",o[i++]=n[a])}return o},WinJSContrib.Utils.getDistinctPropertyValues=function(n,t,r){return Utils.distinctArray(n,t,r).map(function(n){return WinJSContrib.Utils.readProperty(n,t.split("."))})},WinJSContrib.Utils.removeAccents=function(n){var t=n.toLowerCase();return t=t.replace(new RegExp("[àáâãäå]","g"),"a"),t=t.replace(new RegExp("æ","g"),"ae"),t=t.replace(new RegExp("ç","g"),"c"),t=t.replace(new RegExp("[èéêë]","g"),"e"),t=t.replace(new RegExp("[ìíîï]","g"),"i"),t=t.replace(new RegExp("ñ","g"),"n"),t=t.replace(new RegExp("[òóôõö]","g"),"o"),t=t.replace(new RegExp("œ","g"),"oe"),t=t.replace(new RegExp("[ùúûü]","g"),"u"),t=t.replace(new RegExp("[ýÿ]","g"),"y")},WinJSContrib.Utils.removePageFromHistory=function(n){var t=[];WinJS.Navigation.history&&WinJS.Navigation.history.backStack&&WinJS.Navigation.history.backStack.length&&WinJS.Navigation.history.backStack.forEach(function(r){r.location!==n&&t.push(r)}),WinJS.Navigation.history.backStack=t},WinJSContrib.Utils.pad2=function(n){return(10>n?"0":"")+n},WinJSContrib.Utils.ellipsisizeString=function(n,t,r){if(!n)return"";var e=n.length>t,i=e?n.substr(0,t-1):n;return i=r&&e?i.substr(0,i.lastIndexOf(" ")):i,e?i+"...":i},WinJSContrib.Utils.guid=function(){var n=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==t?r:7&r|8).toString(16)});return t},WinJSContrib.Utils.inherit=function(n,t){if(n&&n.parentElement)for(var r=n.parentElement;r;){if(r.winControl&&void 0!=r.winControl[t])return r.winControl[t];r=r.parentElement}},WinJSContrib.Utils.moveChilds=function(n,t){for(var r=[],e=0;e<n.children.length;e++)r.push(n.children[e]);r.forEach(function(n){t.appendChild(n)})},WinJSContrib.Utils.getParent=function(n,t){for(var r=t.parentNode;r;){if(r[n]&&r.winControl)return r.winControl;r=r.parentNode}},WinJSContrib.Utils.getParentControlByClass=function(n,t){for(var r=t.parentNode;r;){if(r.classList.contains(n)&&r.winControl)return r.winControl;r=r.parentNode}},WinJSContrib.Utils.getParentPage=function(n){return WinJSContrib.Utils.getParent("mcnPage",n)},WinJSContrib.Utils.getScopeControl=function(n){for(var t=n.parentNode;t;){if(t.msParentSelectorScope){var r=t.parentNode;if(r){var e=r.winControl;if(e)return e}}t=t.parentNode}},WinJSContrib.Utils.getTemplate=function(n){if(n){var t=typeof n;if("string"==t)return new WinJS.Binding.Template(null,{href:n});if("function"==t)return{render:function(t,r){var e=n(t,r);return WinJS.Promise.as(e)}};if(n.winControl)return n.winControl;if(n.render)return n}},WinJSContrib.Utils.resolveMethod=function(n,t){var r=WinJSContrib.Utils.resolveValue(n,t);return r&&"function"==typeof r?r:void 0},WinJSContrib.Utils.readValue=function(n,t){var r=WinJSContrib.Utils.resolveValue(n,t);return r?"function"==typeof r?r(n):r:void 0},WinJSContrib.Utils.resolveValue=function(n,t){var r,e,i;if(0==t.indexOf("page:")){if(r=t.substr(5),WinJSContrib.Utils.getParentPage&&(e=WinJSContrib.Utils.getParentPage(n)),!e&&WinJSContrib.UI.Application.navigator&&(e=WinJSContrib.UI.Application.navigator.pageControl),!e)return;i=WinJSContrib.Utils.readProperty(e,r),i&&"function"==typeof i&&(i=i.bind(e))}else 0==t.indexOf("ctrl:")?(r=t.substr(5),e=WinJSContrib.Utils.getScopeControl(n),i=WinJSContrib.Utils.readProperty(e,r),i&&"function"==typeof i&&(i=i.bind(e))):(r=t,e=WinJSContrib.Utils.getScopeControl(n),i=WinJSContrib.Utils.readProperty(window,r));return i},WinJSContrib.Utils.hasValue=function(n){return"undefined"!=typeof n&&null!==n},WinJSContrib.Utils.formatXHRError=function(n){return"{0} - {1}: {2}".format(n.status,n.statusText,n.responseText)},WinJSContrib.Utils.unwrapJoinError=function(n){return function(t){for(var r=null,e=0;e<t.length;e++){var i=t[e];if("undefined"!=typeof i){r=i;break}}return n(r)}},WinJSContrib.Utils.inject=function(n,t){if(t)for(var r in t)n[r]=t[r]},WinJSContrib.UI.addFragmentProperties=function(n){n.eventTracker||(n.eventTracker=new WinJSContrib.UI.EventTracker),n.promises||(n.promises=[]),n.addPromise||(n.addPromise=function(n){this.promises.push(n)}),n.cancelPromises||(n.cancelPromises=function(){var n=this;if(n.promises)for(var t=0;t<n.promises.length;t++)n.promises[t]&&n.promises[t].cancel()})},WinJSContrib.UI.renderFragment=function(n,t,s,u){var l;u=u||{};var c=document.createElement("div");c.setAttribute("dir",window.getComputedStyle(c,null).direction),c.style.opacity="0";var f=new WinJS.Promise(function(n){l=n}),p=null,d=[];return WinJS.UI.Pages.render(t,c,s,f).then(function(){return c.winControl&&(p=c.winControl,p.navigationState=s,WinJSContrib.UI.addFragmentProperties(p),s&&s.injectToPage&&WinJSContrib.Utils.inject(p,s.injectToPage),u.onfragmentinit&&u.onfragmentinit(p),p.prepareData&&(p.dataPromise=WinJS.Promise.as(p.prepareData(c,s)),p.promises.push(p.dataPromise))),WinJS.Promise.timeout(10)}).then(function(){return WinJS.Resources.processAll(c)}).then(function(){return p.dataPromise}).then(function(){return u.closeOldPagePromise?WinJS.Promise.as(u.closeOldPagePromise):void 0}).then(function(n){return p.pagedata=n,WinJSContrib.UI.bindMembers(p.element,p),d=r(c),e(p,d,s,u)}).then(function(){return n.appendChild(c),WinJS.Promise.timeout()}).then(function(){return u.onafterlayout&&u.onafterlayout(p),d=r(c),i(p,d,s,u)}).then(function(){return l(),WinJSContrib.UI.bindActions(p.element,p),u.onafterready&&u.onafterready(p),d=r(c),o(p,d,s,u)}).then(function(){return a(p,d,s,u)})}}(WinJSContrib);